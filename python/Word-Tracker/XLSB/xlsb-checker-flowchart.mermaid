flowchart TD
    A[開始] --> B[入力ファイルを読み込む]
    B --> C{入力ファイルの形式は?}
    C -->|CSV| D[CSVから行を読み込む]
    C -->|テキスト| E[テキストファイルから行を読み込む]
    D --> F[ファイルパスのリストを作成]
    E --> F
    F --> G[処理開始時間を記録]
    G --> H[並列処理を初期化]
    H --> I[各ファイルパスに対して処理を実行]
    I --> J{ファイルは存在し、XLSBか?}
    J -->|はい| K[XLSBファイルを開く]
    J -->|いいえ| L[エラーを記録]
    K --> M[全シートを処理]
    M --> N[各行を処理]
    N --> O[各セルを処理]
    O --> P{セルに指定単語が含まれる?}
    P -->|はい| Q[マッチした単語を記録]
    P -->|いいえ| R[次のセルへ]
    Q --> R
    R --> S{全セル処理完了?}
    S -->|いいえ| O
    S -->|はい| T{全行処理完了?}
    T -->|いいえ| N
    T -->|はい| U{全シート処理完了?}
    U -->|いいえ| M
    U -->|はい| V[結果を記録]
    L --> V
    V --> W{全ファイル処理完了?}
    W -->|いいえ| I
    W -->|はい| X[処理終了時間を記録]
    X --> Y{出力ファイルが指定されている?}
    Y -->|はい| Z[結果をCSVに出力]
    Y -->|いいえ| AA[結果を画面に表示]
    Z --> AB{APIのURLが指定されている?}
    AA --> AB
    AB -->|はい| AC[APIに結果を送信]
    AB -->|いいえ| AD[終了]
    AC --> AD